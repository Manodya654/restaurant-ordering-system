version: '3.8'

services:
  # --- Frontend Service ---
  client:
    container_name: react_client
    # Use the specific Dockerfile we created
    build:
      context: .
      dockerfile: Dockerfile.client
    # Expose the client container's port 80 to your host machine's port 8080
    ports:
      - "8080:80"
    # Ensure the client service depends on the backend starting first
    depends_on:
      - server
    networks:
      - app-network

  # --- Backend Service ---
  server:
    container_name: node_server
    # Use the specific Dockerfile we created
    build:
      context: .
      dockerfile: Dockerfile.server
    # Expose the backend container's port 3000 to your host machine's port 3000
    ports:
      - "3000:3000"
    # Optional: Volume mount for faster development (hot-reloading)
    # volumes:
    #   - ./server:/app/server:delegated
    #   - /app/server/node_modules
    networks:
      - app-network
    environment:
      # Example: Pass necessary environment variables to the backend
      NODE_ENV: development
      # Set the URL where the client expects the backend to be
      CLIENT_ORIGIN: http://localhost:8080

# --- Network Definition ---
networks:
  app-network:
    driver: bridge